<!DOCTYPE html>

<html>
    <head>
        <title>BASIC | FLOWDOCODE</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" media="screen" href="../css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="../css/jquery-ui.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="../css/main.css" />
        <script src="../js/jquery.js"></script>
        <script src="../js/jquery-ui.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/flowdocode.js"></script>



    </head>
    <style>
  
    </style>
    <body>
      
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link "href="Basic.html">Basic</a>
          </li>
      <li class="nav-item">
        <a class="nav-link "href="Decision.html">Decision</a>
      </li>
      <li class="nav-item">
        <a class="nav-link "href="Loop.html">Loop</a>
      </li>
     
    </ul>
  </div>
 

  
</nav>

      <div class="col-2 con-fixed h-100 pb-5" >
              <div class="my-5  toolbox start-end " id="end"draggable="true" ondragstart="drag(event)">
                <svg   stroke="red" fill="none">
                  <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  End
                </div>
              </div>
              <div class="my-5 toolbox process" id="process"draggable="true" ondragstart="drag(event)">
                <svg   >
                  <path d="M 0 0 L 150 0 L 150 50 L 0 50 Z"/>
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  Process
                </div>
              </div>
              <div class="my-5  toolbox manual-input"id="manual-input" draggable="true"ondragstart="drag(event)" >
                <svg   >
                  <path d="M 0 10 L 150 0 L 150 50 L 0 50 Z"/>
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  Input
                </div>
              </div>
              <div class="my-5  toolbox decision"id="decision" draggable="true"ondragstart="drag(event)" >
                <svg   >
                  <path d="M 75 0 L 150 25 L 75 50 L 0 25 Z "/>
                </svg>
                <div class="text text-center  col-6 text-truncate mx-auto"  >
                  Input
                </div>
              </div>
              <div class="my-5 toolbox monitor"id="monitor" draggable="true"ondragstart="drag(event)">
                <svg   >
                  <path d="M 0 25 L 15 50 H 120 C 155 50 ,155 0, 120 0 H 15 L 0,25  "/>
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  Display
                </div>
              </div>
              <div class="my-5 toolbox connect"id="connect" >
                <svg  stroke="red" fill="none" >
                  <circle cx="50" cy="50" r="45"   />            
                </svg>
                <div class="text text-center col-4 p-0   text-truncate mx-auto"  >
                  Connect
                </div>
              </div>
              
     
      </div>
      
      <div class="offset-2 col-8 py-5 con-fixed h-75 " id="content"ondragover="allowDrop(event)"ondrop="dropItem(event)">
        
        <div class="toolbox shape start-end " id="start"  >
          <svg   >
            <path d="M 25 0 C -5,0 -5,50 25,50 L 175 50 C 200,50 200,0 175,0 Z"/>                
          </svg>
          <div class="text text-center col-8  text-truncate mx-auto" >
            Start
          </div>
        </div>
       
       
      </div>

      <div class="col-8 con-fixed h-25 offset-2 fixed-bottom"id="console" style="background: #fff;">Console</div>                                          
  
      <div class="offset-10 col-2  con-fixed h-100" >
        <button>Compile</button>
      </div>


 

    </body>


    <script>
     
      $(function(){
        var selectedEl=undefined;
        $(".toolbox").each(function (){
          updateTextboxPosition($(this),10);
        });
        $(".shape").each(function (){
          updateTextboxPosition($(this),15);
        });
        let p={
          top:87,
          left:650
        }
        $("#start").offset(p);
        $(".shape").draggable();
          
        
  
      });  
  
  function allowDrop(event) {
    event.preventDefault();
  }
  function drag(ev) {
  
  // ev.dataTransfer.setData("text", ev.target.getAttribute('data-type'));
  ev.dataTransfer.setData("text", ev.target.id);
  
  
  }
  function dropItem(event){
  
  
    event.preventDefault();
    var type=event.dataTransfer.getData("text");
    var mousePoint={
      left: event.clientX ,
      top: event.clientY
    }
  
    if(type!=null){
       
       if($("#content").find("."+type+"").last().index()==-1){
         var index=0;
       }else{
         var str= $("#content").find("."+type+"").last().prop("id");
         str=str.split("-");
       
          var index=str[str.length-1];
          index++;
       }
  
       var obj=document.createElement("div");
       if(type=="end"){
         var attrObj={
          class:"py-2 shape start-end ",
          id:"End"
        } 
  
       }else{
          var attrObj={
          class:"shape text-truncate text-center py-2 "+type,
          id:(type+"-"+index),
          contenteditable:true
          
          }
       }
  
        var obj=document.createElement("div");
        $(obj).attr(attrObj);    
       
        $(obj).text(attrObj.id);
        $("#content").append($(obj));
        $(obj).offset(mousePoint);
        $(obj).draggable();
        $(obj).resizable({handles: "e,  w"});
       
  
        
  
  
        
    }
      
     
  }
  
  $("div").on("click",".shape",function(){
    document.body.style.cursor="text";
    var obj=$(this);
    if(!$(obj).hasClass("start-end")){
      $(obj).prop("contenteditable",true);
      $(selectedEl).draggable({ disabled: true });
    }
    $(document).keydown(function(ev){
  
    if(ev.keyCode==13){
      disContentEdit(obj);
      if(obj.text()==""){
      obj.text(obj.attr("id"));
      }
    }
    
  
    });
  
   
  
  });
  $(document).on("blur",".shape",function(){
    disContentEdit($(this));
    shapeUnSelectedStyle();
  
  });
  $("#content").on("mouseup",function(event){
    if(event.target === this)
      shapeUnSelectedStyle();
  });
  
  $(document).on("mouseenter",".shape",function(){
    document.body.style.cursor="grab";
  });
  $(document).on("mouseleave",".shape",function(){
    document.body.style.cursor="";
  });
  $(document).on("mousedown",".shape",function(){
    if(selectedEl!=undefined){
  
      shapeUnSelectedStyle();
    selectedEl=$(this);
    document.body.style.cursor="";
    
    document.body.style.cursor="grabing";
    shapeSelectedStyle();
      $(document).keydown(function(ev){
  
      if((ev.keyCode==8||ev.keyCode==46||ev.keyCode==110)&&(selectedEl.prop("contenteditable")!="true")){
  
  
        $(selectedEl).remove();
      }
  
      });
    }
    
  });
  $(document).on("mouseup",".shape",function(){
    selectedEl=$(this);
    shapeSelectedStyle();
    document.body.style.cursor="grab";
  });
  
  function shapeSelectedStyle(){
    try {
      selectedEl.css({
      "border-style":"dashed",
      "border-width":"2px"
    });
    } catch (error) {
  
  
    }
  
  
  }
  function shapeUnSelectedStyle(){
    try {
      selectedEl.css({
      "border-style":"solid",
      "border-width":"1px"
      });
     
  
    } catch (error) {
  
  
    }finally{
      selectedEl=undefined;
  
    }
    
  
   
  
  }
  function disContentEdit(obj){
  
  $(obj).prop("contenteditable",false);
  $(obj).draggable({ disabled: false });
  document.body.style.cursor="";
  }
  
  
  
  
  function generateAnchor(node){
  
  
  }
  
  
  
      </script> 
  <scrip type="text/template">
    <template id="end">
      <div class="shape start-end " >
          <svg   >
            <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
          </svg>
          <div class="text text-center col-6  text-truncate mx-auto"  >
            End
          </div>
      </div>
    <template> 
    <template id="process">
        <div class="shape process "id="" >
            <svg   >
              <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
            </svg>
            <div class="text text-center col-6  text-truncate mx-auto"  >
              End
            </div>
        </div>
    <template>
    <template id="input">
            <div class="my-5  shape input " >
                <svg   >
                  <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  End
                </div>
            </div>
      <template>   
      <template id="decision">
        <div class="my-5  shape decision " >
          <svg>
                        <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
          </svg>
          <div class="text text-center col-6  text-truncate mx-auto"  >
            End
          </div>
        </div>
      <template>
          <template id="decision">
              <div class="my-5  shape decision " >
                <svg>
                              <path d="M 25 0 C -5,0 -5,50 25,50 L 120 50 C 155,50 155,0 120,0 Z"/>                
                </svg>
                <div class="text text-center col-6  text-truncate mx-auto"  >
                  End
                </div>
              </div>
            <template>


  </scrip>
</html>


