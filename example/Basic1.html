<!DOCTYPE html>

<html>
    <head>
        <title>BASIC | FLOWDOCODE</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" media="screen" href="../css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="../css/jquery-ui.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="../css/main.css" />
        <script src="../js/jquery.js"></script>
        <script src="../js/jquery-ui.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script src="../js/flowdocode.js"></script>



    </head>
    <body>
      
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link "href="Basic.html">Basic</a>
          </li>
      <li class="nav-item">
        <a class="nav-link "href="Decision.html">Decision</a>
      </li>
      <li class="nav-item">
        <a class="nav-link "href="Loop.html">Loop</a>
      </li>
     
    </ul>
  </div>
 

  
</nav>

      <div class="col-2 con-fixed h-100 pb-5" >
              <div class="my-5 py-2 start-end " id="end"draggable="true" ondragstart="drag(event)">End</div>
              <div class="my-5 py-2 process" id="process"draggable="true" ondragstart="drag(event)">process</div>
              <!-- <div class="my-5 py-2 input-output"id="input-output" draggable="true" >input-output</div> -->
              <div class="my-5 py-2 manual-input"id="manual-input" draggable="true"ondragstart="drag(event)" > manual-input</div>
              <div class="my-5 py-2 decision"id="decision" draggable="true"ondragstart="drag(event)" >decision</div>
              <!-- <div class="my-5 py-2 duc"id="duc" draggable="true">duc</div> -->
              <div class="my-5 py-2 monitor"id="monitor" draggable="true"ondragstart="drag(event)">monitor</div>
              <div class="my-5 py-2 base"id="base" draggable="true"ondragstart="drag(event)">base</div>
              <div class="my-5 py-2 circle"id="circle"draggable="true"ondragstart="drag(event)">circle</div> 
     
      </div>
      
      <div class="offset-2 col-8 py-5 con-fixed h-75 " id="content"ondragover="allowDrop(event)"ondrop="dropItem(event)">
        <div class="my-5 py-2 start-end shape" id="start"data-next="process-0">Start</div>
        <div class="my-5 py-2 process shape"contenteditable="true" >asdas</div>

      </div>

      <div class="col-8 con-fixed h-25 offset-2 fixed-bottom"id="console" style="background: #fff;">Console</div>                                          
  
      <div class="offset-10 col-2  con-fixed h-100" >
        <button>Compile</button>
      </div>


 

    </body>


    <script>
      $(function(){
        var selectedEl=undefined;
        $(".shape").draggable();
        $(".shape").resizable({handles: "e,  w"});
  
      });  
  
  function allowDrop(event) {
    event.preventDefault();
  }
  function drag(ev) {
  
  // ev.dataTransfer.setData("text", ev.target.getAttribute('data-type'));
  ev.dataTransfer.setData("text", ev.target.id);
  
  
  }
  function dropItem(event){
  
  
    event.preventDefault();
    var type=event.dataTransfer.getData("text");
    var mousePoint={
      left: event.clientX ,
      top: event.clientY
    }
  
    if(type!=null){
       
       if($("#content").find("."+type+"").last().index()==-1){
         var index=0;
       }else{
         var str= $("#content").find("."+type+"").last().prop("id");
         str=str.split("-");
       
          var index=str[str.length-1];
          index++;
       }
  
       var obj=document.createElement("div");
       if(type=="end"){
         var attrObj={
          class:"py-2 shape start-end ",
          id:"End"
        } 
  
       }else{
          var attrObj={
          class:"shape text-truncate text-center py-2 "+type,
          id:(type+"-"+index),
          contenteditable:true
          
          }
       }
  
        var obj=document.createElement("div");
        $(obj).attr(attrObj);    
       
        $(obj).text(attrObj.id);
        $("#content").append($(obj));
        $(obj).offset(mousePoint);
        $(obj).draggable();
        $(obj).resizable({handles: "e,  w"});
       
  
        
  
  
        
    }
      
     
  }
  
  $("div").on("click",".shape",function(){
    document.body.style.cursor="text";
    var obj=$(this);
    if(!$(obj).hasClass("start-end")){
      $(obj).prop("contenteditable",true);
      $(selectedEl).draggable({ disabled: true });
    }
    $(document).keydown(function(ev){
  
    if(ev.keyCode==13){
      disContentEdit(obj);
      if(obj.text()==""){
      obj.text(obj.attr("id"));
      }
    }
    
  
    });
  
   
  
  });
  $(document).on("blur",".shape",function(){
    disContentEdit($(this));
    shapeUnSelectedStyle();
  
  });
  $("#content").on("mouseup",function(event){
    if(event.target === this)
      shapeUnSelectedStyle();
  });
  
  $(document).on("mouseenter",".shape",function(){
    document.body.style.cursor="grab";
  });
  $(document).on("mouseleave",".shape",function(){
    document.body.style.cursor="";
  });
  $(document).on("mousedown",".shape",function(){
    if(selectedEl!=undefined){
  
      shapeUnSelectedStyle();
    selectedEl=$(this);
    document.body.style.cursor="";
    
    document.body.style.cursor="grabing";
    shapeSelectedStyle();
      $(document).keydown(function(ev){
  
      if((ev.keyCode==8||ev.keyCode==46||ev.keyCode==110)&&(selectedEl.prop("contenteditable")!="true")){
  
  
        $(selectedEl).remove();
      }
  
      });
    }
    
  });
  $(document).on("mouseup",".shape",function(){
    selectedEl=$(this);
    shapeSelectedStyle();
    document.body.style.cursor="grab";
  });
  
  function shapeSelectedStyle(){
    try {
      selectedEl.css({
      "border-style":"dashed",
      "border-width":"2px"
    });
    } catch (error) {
  
  
    }
  
  
  }
  function shapeUnSelectedStyle(){
    try {
      selectedEl.css({
      "border-style":"solid",
      "border-width":"1px"
      });
     
  
    } catch (error) {
  
  
    }finally{
      selectedEl=undefined;
  
    }
    
  
   
  
  }
  function disContentEdit(obj){
  
  $(obj).prop("contenteditable",false);
  $(obj).draggable({ disabled: false });
  document.body.style.cursor="";
  }
  
  
  
  
  function generateAnchor(node){
  
  
  }
  
  
  
      </script> 
  
</html>


