<!DOCTYPE html>

<html>
    <head>
        <title>flowdocode</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />
        <link rel="stylesheet" type="text/css" media="screen" href="css/fontawesome.min.css" />
        <script src="js/jquery.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/vue.js"></script>
        <script src="js/fontawesome.min.js"></script>
        <script src="js/flowdocode.js"></script>
        <script src="js/interact.js"></script>


    </head>
    <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
    <ul class="navbar-nav">

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Dropdown link
        </a>
        <div class="dropdown-menu " aria-labelledby="navbarDropdownMenuLink">
          <a class="dropdown-item a" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
    </ul>
  </div>


</nav>


      <div class="col-2 con-fixed h-100 pb-5" >
              <div class="my-5 shape start-end" id="start-end"data-type="tools"draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape process" id="process"data-type="tools"draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape input-output"id="input-output"data-type="tools" draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape manual-input"id="manual-input"data-type="tools" draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape decision"id="decision"data-type="tools" draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape duc"id="duc"data-type="tools" draggable="true" ondragstart="drag(event)"></div>
              <div class="my-5 shape monitor"id="monitor"data-type="tools" draggable="true"ondragstart="drag(event)"></div>
              <div class="my-5 shape base"id="base" data-type="tools"draggable="true"ondragstart="drag(event)"></div>
              <div class="my-5 shape circle" data-type="tools"id="circle"draggable="true"ondragstart="drag(event)"></div> 
     
      </div>
      
      <div class="offset-2 col-8 py-5 con-fixed h-75" id="content"ondragover="allowDrop(event)"ondrop="drop(event)">
          
 
      </div>
      <div class="col-8 con-fixed h-25 offset-2 fixed-bottom" style="background: red;">Console</div>                                          
  
      <div class="offset-10 col-2  con-fixed h-100" >
        <button>test</button>
      </div>


 
    </body>
    <script>

    function allowDrop(ev) {
    ev.preventDefault();
}
$("button").click(function(){
  console.log($("#content").html());
});

function drag(ev) {

  // ev.dataTransfer.setData("text", ev.target.getAttribute('data-type'));
  var id=ev.dataTransfer.setData("text", ev.target.id);
 
}
function test(event){
  event.preventDefault();
  console.log(event.clientX);
}
function drop(ev) {

  ev.preventDefault();
    var type = ev.dataTransfer.getData("text");
    if(type!=null){
     var index= $("#content").find("."+type+"").last().index();
      var objClass=" shape-content text-truncate text-center resize-drag "+type;
      var objId=(type+index);
      var objAttr=" contenteditable='true'";
      var str="<div class='"+objClass+"'id='"+objId+"' "+objAttr+" >"+(type+index)+"</div>"
      $("#content").append(str);
    }
   
}

interact('.draggable')
  .draggable({
    // enable inertial throwing
    inertia: true,
    // keep the element within the area of it's parent
    restrict: {
      restriction: "parent",
      endOnly: true,
      elementRect: { top: 0, left: 0, bottom: 1, right: 1 }
    },
    // enable autoScroll
    autoScroll: true,

    // call this function on every dragmove event
    onmove: dragMoveListener,
    // call this function on every dragend event
    onend: function (event) {
      var textEl = event.target.querySelector('p');

      textEl && (textEl.textContent =
        'moved a distance of '
        + (Math.sqrt(Math.pow(event.pageX - event.x0, 2) +
                     Math.pow(event.pageY - event.y0, 2) | 0))
            .toFixed(2) + 'px');
    }
  });

  function dragMoveListener (event) {
    var target = event.target,
        // keep the dragged position in the data-x/data-y attributes
        x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
        y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

    // translate the element
    target.style.webkitTransform =
    target.style.transform =
      'translate(' + x + 'px, ' + y + 'px)';

    // update the posiion attributes
    target.setAttribute('data-x', x);
    target.setAttribute('data-y', y);
  }

  // this is used later in the resizing and gesture demos
  window.dragMoveListener = dragMoveListener;
  

  // RESIZE
  interact('.resize-drag')
  .draggable({
    onmove: window.dragMoveListener,
    restrict: {
      restriction: 'parent',
      elementRect: { top: 0, left: 0, bottom: 1, right: 1 }
    },
  })
  .resizable({
    // resize from all edges and corners
    edges: { left: true, right: true, bottom: true, top: true },

    // keep the edges inside the parent
    restrictEdges: {
      outer: 'parent',
      endOnly: true,
    },

    // minimum size
    restrictSize: {
      min: { width: 100, height: 50 },
    },

    inertia: true,
  })
  .on('resizemove', function (event) {
    var target = event.target,
        x = (parseFloat(target.getAttribute('data-x')) || 0),
        y = (parseFloat(target.getAttribute('data-y')) || 0);

    // update the element's style
    target.style.width  = event.rect.width + 'px';
    target.style.height = event.rect.height + 'px';

    // translate when resizing from top or left edges
    x += event.deltaRect.left;
    y += event.deltaRect.top;

    target.style.webkitTransform = target.style.transform =
        'translate(' + x + 'px,' + y + 'px)';

    target.setAttribute('data-x', x);
    target.setAttribute('data-y', y);
  });
    </script>
</html>


