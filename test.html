<!DOCTYPE html>

<html>

<head>
  <title>FlowdoCode | FLOWDOCODE</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" media="screen" href="css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/jquery-ui.min.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/font-awesome-all.min.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />
  <!-- <link rel="stylesheet" type="text/css" media="screen" href="css/darktheme.css" /> -->



  <script src="js/jquery.js"></script>
  <script src="js/jquery-ui.min.js"></script>
  <script src="js/popper.min.js"></script>

  <script src="js/bootstrap.min.js"></script>

  <script src="js/flowdocode.js"></script>
  <script src="js/compiler.js"></script>
  <script src="js/debugger.js"></script>
  <script src="js/font-awesome-all.min.js"></script>
  <script src="js/vue.js"></script>




</head>
<script>


</script>

<body>
<svg id="#canvas" style="top:0;left:0;">
  <polyline points="1,1 100,100" id="test"></polyline>

</svg>






</body>

<script>
  $(function(){
    let from={x:100,y:100,anchor:"top"};
    let to={x:100,y:300,anchor:"top"};
    drawConnector(from,to);
  });
  function drawConnector(from,to){
    let distanceX=Math.abs(from.x-to.x);
    let distanceY=Math.abs(from.y-to.y);
    let rootStart=roots(from);
    let axis=(from.anchor=="top"||from.anchor=="bottom"?"horizontal":"vertical");
    let rootEnd=roots(to);
    let start =getToPoint(from.x,from.y)+jsonToPoint(rootStart);
    points=start;

      rootStart=findPath(rootStart,rootEnd,axis,distanceX,distanceY);
      axis=(axis=="vertical"?"horizontal":"vertical");
      points+=jsonToPoint(rootStart);

      rootStart=findPath(rootStart,rootEnd,axis,distanceX,distanceY);
      axis=(axis=="vertical"?"horizontal":"vertical");
      points+=jsonToPoint(rootStart);

      rootStart=findPath(rootStart,rootEnd,axis,distanceX,distanceY);
      axis=(axis=="vertical"?"horizontal":"vertical");
      points+=jsonToPoint(rootStart);

    
    

    let end =getToPoint(to.x,to.y)+jsonToPoint(rootEnd);
    points+=end;
    $("#test").attr("points",points);
  }
  function getToPoint(x,y){
    return x+","+y+" ";
  }
  function findPath(cp,to,axis,distanceX,distanceY){
    let x,y;
    console.log(axis);
    if(axis=="horizontal"){
      if(cp.x>=to.x){
        rs=cp.x+distanceX;
      }else{
        rs=cp.x-distanceX;
      }
      x=rs;
      y=cp.y;
   
    }else{
      if(cp.y>=to.y){
        rs=cp.y-distanceY;
      }else{
        rs=cp.y+distanceY;
      }
      x=cp.x;
      y=rs;
    }
    console.log({x,y});
    return {x,y};
  }
  function roots(json){
    switch (json.anchor) {
      case "top":
        return { x:json.x, y: json.y - 40 };

      case "right":

        return { x: json.x + 40, y: json.y };

      case "bottom":


        return { x: json.x, y: json.y + 40 };

      case "left":
        return { x:json.x - 40, y: json.y };

    }
  }

</script>


</html>